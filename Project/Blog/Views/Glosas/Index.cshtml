@{
    ViewBag.Title = "Blog";
    ViewBag.Opcion = "Administración";
    ViewBag.SubOpcion = "Glosas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<form method="POST">

    <div class="col-md-12">
        <div class="box box-primary" style="height: 100%">
            <br />
            <div id="grid"></div>
        </div>
    </div>
    <style>
        .k-grid tbody tr {
            height: 30px;
        }
        .k-grid td {
            padding: 0.1em 0.1em
        }
    </style>
</form>

<script>
    var dsUsuario = new kendo.data.DataSource({
        pageSize:10,
        transport: {
            read: {
                url: "@Url.Action("LoadGrid", "Glosas")",
            type: "POST"
        }
    },
        schema: {
            model: {
                id: "IdGlosa",
                fields: {
                    IdGlosa:{editable:false}
        }
    }
    }
    });
    var gridUsuario = $("#grid").kendoGrid({
        toolbar: ["excel"],
        excel: {
            allPages: true
        },
        excelExport: function (e) {
            e.workbook.fileName = "Glosas.xlsx";
        },
        columns: [
            { field: "IdGlosa", title: "Código", hidden:true },
            { field: "__GlosaST", title: "Servicio Técnico", attributes: { style: "text-align: center; white-space: nowrap;" } },
            { field: "GlosaPQR", title: "PQR", attributes: { style: "text-align: center; white-space: nowrap;" } },
            { field: "GlosaNormalizacion", title: "Normalizaciones", attributes: { style: "text-align: center; white-space: nowrap;" } }
            @if (((List<Blog.Entity.PERFIL>)Session[Blog.Helpers.Constant.PERFILES]).FirstOrDefault(p => p.ID_FUNCION == (Convert.ToInt32(Blog.Helpers.Functions.Glosas_Editar))) != null)
            {
                @MvcHtmlString.Create(@" ,{ template: ""<a class='btn btn-success' href='" + (Url.Action("Update", "Glosas")) + "?id=#= IdGlosa #'><span class='fa fa-edit'></span> Editar</a>" + @"""}");
            }
        ],
    sortable:true,
    scrollable: true,
    pageable: {
        pageSizes: false,
        messages: {
            itemsPerPage: "Registros por página",
            display: "Mostrando {0}-{1} de {2} registros"
        }
    },
    culture: "es-CO",
        dataSource: dsUsuario
    }).data("kendoGrid");
</script>


<script>
    $(document).ready(function () {
        @if (!String.IsNullOrEmpty(ViewBag.Error))
        {
            @Html.Raw((string.Format("ShowMessageError('{0}');", ViewBag.Error )))
        }

        @if (!String.IsNullOrEmpty(ViewBag.Success))
        {
            @Html.Raw((string.Format("ShowMessageSuccess('{0}');", ViewBag.Success)))
        }

    });
</script>
